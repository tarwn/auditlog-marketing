<!doctype html>
<html lang="en">
<head>
    <title>API Documentation</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Transparency that enables">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for https://www.auditlog.co" href="/rss.xml" />
    
    <link href="https://fonts.googleapis.com/css?family=Raleway|Oxygen" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/styles/lib/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/styles/stylesheet.css" />
    
    <link rel="apple-touch-icon" sizes="57x57" href="/images/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/images/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">    <script src="/scripts/jquery-3.3.1.min.js"></script>
    <script src="/scripts/jquery.waypoints.min.js"></script>
    <script src="/scripts/highlight.pack.js"></script>

    <!-- <link rel="stylesheet" type="text/css" href="/styles/highlight/solarized-dark.css" /> -->
    <link rel="stylesheet" type="text/css" href="/styles/highlight/solarized-dark.css" />
    <script src="/scripts/highlight.pack.js"></script>
</head>
<body>
  
<div class="alm-api-area">

    <div class="alm-api-sidebar">
        <header class="alm-api-header">
            <a href="/" class="alm-logo">
                <img src="/images/logo56.png" alt="AL" />
                <span>auditlog</span>
            </a>
        </header>
        
        <div class="alm-api-menu">
            <ul>
                <li><a href="#api-reference">API Reference</a></li>
                <li><a href="#authentication">Authentication</a></li>
                <li><a href="#errors">Errors</a></li>
                <li><a href="#immutable">Immutability and Events</a></li>
                <li><a href="#versioning">API Versioning</a></li>
                <li>
                    <a href="#types">Core Types</a>
                    <ul>
                            <li><a href="#types-event">Event</a></li>
                            <li><a href="#types-actor">Actor</a></li>
                            <li><a href="#types-client">Client</a></li>
                            <li><a href="#types-view">View</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#event-reporting">Submitting Data</a>
                    <ul>
                        <li><a href="#events-api-post">Events</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#event-querying">Querying Data</a>
                    <ul>
                        <li><a href="#views-api-get">Views</a></li>
                        <li><a href="#events-api-get">Events</a></li>
                    </ul>
                </li>
                <li>
                    <a href="actors-api">Users / Actors</a>
                    <ul>
                        <li><a href="#actors-api-search">Search</a></li>
                        <li><a href="#actors-api-update">Update</a></li>
                        <li><a href="#actors-api-forget">Forget</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
    <div class="alm-api-main">
        <div class="alm-api-background">
        </div>
        <div class="alm-api-sections" id="scrollable-main">
            <div class="alm-api-section">
                <div class="alm-api-section-left first">
                    <h1 id="api-reference"><a href="#api-reference">API Reference</a></h1>
                    <p>
                        Welcome to AuditLog's API! The API enables you to <a href="#event-reporting">submit Events</a>, 
                        query customized Views and Events with <a href="#event-querying">Event Queries</a>, and
                        satisfy privacy needs with the <a href="#actors-api">Actor API</a>.
                    </p>
                    <p>
                        The API is organized around <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank">REST</a>. 
                        All requests should be made over SSL. All request and response bodies, including errors, support JSON and XML. Standard content type 
                        headers should be used to indicate <code>application/json</code> or <code>text/xml</code>.
                    </p>
                    <p>
                        Authentication to the API is performed via a custom <code>X-API-KEY</code> header and is required for all requests.
                    </p>
                </div>
                <div class="alm-api-section-right first"></div>
            </div>
            <div class="alm-api-section">
                <div class="alm-api-section-left first">
                    <h1 id="authentication"><a href="#authentication">Authentication</a></h1>
                    <p>
                        Authentication is done via the Consumer Id and Secret which can be managed in the
                        <a href="https://app.auditlog.co/configure/apikeys">Configure API Keys</a> section of
                        the application.
                    </p>
                    <p>
                        Requests are authentications using a custom <code>X-API-KEY</code> header containing the Consumer Id and 
                        Secret as a colon-seperated string: <i>{consumer id}</i>:<i>{secret}</i>
                    </p>
                    <p>
                        You can see generated Consumer Id's and create and roll Consumer Secrets from the <a href="https://app.auditlog.co/configure/apikeys">application</a>.
                    </p>
                </div>
                <div class="alm-api-section-right first">
                    <blockquote class="alm-lang-curl">Authentication using X-API-KEY HTTP Header.</blockquote>
                    <pre class="highlight lang-bash alm-lang-curl">
                    curl 'https://app.auditlog.co/api/v1/actors/{user uuid}' \
                        -H 'x-api-key: {consumer id}:{secret}'
                        -H 'accept: application/json'
                    </pre>
                </div>
            </div>
            <div class="alm-api-section">
                <div class="alm-api-section-left">
                    <h1 id="errors"><a href="#errors">Errors</a></h1>
                    <p>
                        The API returns standard HTTP success and error codes. For errors, it will also include 
                        extra information about what went wrong in structured JSON or XML. Standard HTTP status
                        codes are listed below and called out on API operations further below.
                    </p>
                    <h2>HTTP Status Codes</h2>
                    <p>
                        <table>
                            <tr><th>Code</th><th>Title</th><th>Description</th></tr>
                            <tr><td>200</td><td>OK</td><td>The request was successful</td></tr>
                            <tr><td>400</td><td>Bad Request</td><td>Bad request, typically missing or invalid inputs</td></tr>
                            <tr><td>401</td><td>Unauthorized</td><td>API key details not provided</td></tr>
                            <tr><td>402</td><td>Over quota</td><td>Your request has been rate limited</td></tr>
                            <tr><td>403</td><td>Unauthorized</td><td>Could not validate your API key</td></tr>
                            <tr><td>404</td><td>Not Found</td><td>Requested resource was not found</td></tr>
                            <tr><td>50x</td><td>Internal Server Error</td><td>An error occurred in our service</td></tr>
                        </table>
                    </p>
                </div>
            </div>
            <div class="alm-api-section">
                <div class="alm-api-section-left">
                    <h2>ApiError Type</h2>
                    <p>
                        Additional details are returned with many errors, encoded in either JSON or XML (per the provided <code>ACCEPTS</code> HTTP header).
                        <table>
                            <tr><th>Property</th><th></th><th>Description</th></tr>
                            <tr><td>statusCode</td><td>int</td><td>HTTP Status code</td></tr>
                            <tr><td>message</td><td>string</td><td>Human-readable error message</td></tr>
                            <tr><td>details</td><td>key/values</td><td>Key/value list of additional details</td></tr>
                        </table>
                    </p>
                </div>
                <div class="alm-api-section-right alm-extra-top-margin">
                    <blockquote class="alm-lang-curl">Example response when POSTing without a required field.</blockquote>
                    <pre class="highlight lang-json alm-lang-curl">
                    {
                        "statusCode": 400,
                        "message": "Bad Request",
                        "details": {
                            "[0].uuid": "The UUID field is required."
                        }
                    }
                    </pre>
                </div>
            </div>

            <div class="alm-api-section">
                <div class="alm-api-section-left">
                    <h1 id="immutable"><a href="#immutable">Immutability and Events</a></h1>
                    <p>
                        Immutability is a tricky topic for audit logs. An Auditable Event is an Action 
                        against a Target by an Actor at a given Time. We then layer on some additional
                        information for readabaility, augmenting an Actors unique id with a human readable
                        name, for instance.
                    </p>
                    <p>
                        Most of the fields from a reported Event will be stored as an immutable part of the
                        event. The primary exception is Actors. On the Event, we store the <abbr title="Universally Unique Identifier">UUID</abbr>
                        for the actor, but store the Actor's name, email, or other provided information on
                        a single unique record for the Actor. 
                    </p>
                    <p>
                        Keeping a seperate Actor record enables a few key things:
                        <ul>
                            <li><u>Readability</u> - The Actor UUID is part of the immutable record, the mispelling in John's name 3 years ago when he first logged in is not</li>
                            <li><u>Privacy</u> - These fields are potentially personally identifiable, this makes it easy to identify and redact them</li>
                            <li><u>Immutable Log</u> - Separating these fields means there is no need for an Update operation on Events</li>
                        </ul>
                    </p>
                    <h2>Warning: Personally Identifiable Data</h2>
                    <p>
                        Do not include personally identifiable data outside the fields for Actor and Target.
                    </p>
                    <p>
                        Data for Actors and Targets submitted with Target Type of <code>User</code> will be stored beside
                        the immutable record, where it can be reported back and redacted. No other Event fields currently
                        support this reporting or redaction.
                    </p>
                </div>
                <div class="alm-api-section-right alm-extra-top-margin">
                    <blockquote class="alm-lang-curl">Example of an Actor record</blockquote>
                    <pre class="highlight lang-json alm-lang-curl">
                    {
                        "uuid": "bd275099-e808-4c1a-bd32-57a589b7cf93",
                        "name": "Roberta Wharton",
                        "email": "rwharton@great-client.test",
                        "isForgotten": false
                    }
                    </pre>
                    <blockquote class="alm-lang-curl">Example after /actor/{UUID}/forget</blockquote>
                    <pre class="highlight lang-json alm-lang-curl">
                    {
                        "uuid": "bd275099-e808-4c1a-bd32-57a589b7cf93",
                        "name": "[forgotten]",
                        "email": "[forgotten]",
                        "isForgotten": true
                    }
                    </pre>
                </div>
            </div>
            <div class="alm-api-section">
                <div class="alm-api-section-left">
                    <h1 id="versioning"><a href="#versioning">Versioning</a></h1>
                    <p>
                        When we make backwards-incompatible changes to the API, we release a new version.
                        The current version is <strong>v1</strong>. 
                    </p>
                    <p>
                        The API Version is provided as part of the URL for each endpoint. Responses return
                        data structured for the provided version.
                    </p>
                </div>
            </div>

        <!-- <div class="alm-api-section">
                <div class="alm-api-section-left">
                    <h1 id="sample-section"><a href="#sample-section">Sample Section</a></h1>
                    <p>
                    Content goes in paragraph tags.
                    </p>
                </div>
                <div class="alm-api-section-right alm-extra-top-margin">
                    <blockquote class="alm-lang-curl">Example code label with per-language class</blockquote>
                    <pre class="highlight lang-json alm-lang-curl">
                    example code w/ alm-lang-* class for language selection and lang-* for highlight.js
                    </pre>
                </div>
            </div> -->
        </div>
        <nav class="alm-api-lang-selector">
                <a data-language="curl" href="javascript: void(0);">Curl</a>
                <a data-language="notcurl" href="javascript: void(0);">Curl</a>
                <span>More options soon</span>
        </nav>
    </div>
</div>
<script type="text/javascript">
var currentOptions = {
    language: '',
    location: undefined
};

function setFromUrl(defaultValue, availableLanguages){
    var url = window.location.href;
    var regex =  new RegExp('[?&]([^&#]*)');
    var match = regex.exec(url);
    if(match != null && match[1] != null && availableLanguages.indexOf(match[1]) >= 0){
        currentOptions.language = match[1];
    }
    else{
        currentOptions.language = defaultValue;
    }

    var hash = location.hash.replace(/^#/, '');
    currentOptions.location = hash;
}

function applySelectedLanguage(){
    $('a[data-language]').removeClass('selected');
    $('a[data-language="' + currentOptions.language + '"]').addClass('selected');

    applyMenuHighlight();

    $('.alm-api-section-right blockquote').hide();
    $('.alm-api-section-right pre').hide();
    $('.alm-lang-' + currentOptions.language).show();

    history.pushState({}, "AuditLog.co - API: " + currentOptions.language, "?" + currentOptions.language + "#" + (currentOptions.location || ""));
}

function applyMenuHighlight(){
    $('.alm-api-menu a').removeClass('selected');
    $('.alm-api-menu a[href="#' + currentOptions.location + '"]').addClass('selected');
}

function applyWaypoints(){
    $('h1[id]').waypoint({
        handler: function(){ 
            currentOptions.location = this.element.id;
            applySelectedLanguage();
        },
        context: document.getElementById('scrollable-main'),
        offset: 25
    });

    $('h1[id]').waypoint({
        handler: function(){ 
            currentOptions.location = this.element.id;
            applySelectedLanguage();
        },
        context: document.getElementById('scrollable-main'),
        offset: -25
    });
}

function hashChanged(){
    var hash = location.hash.replace(/^#/, '');
    currentOptions.location = hash;

    applyMenuHighlight();
}

$().ready(function(){
    var availableOptions = $('a[data-language]');
    var availableLanguages = [];
    availableOptions.each(function(i, a) { availableLanguages.push($(a).data('language')); });
    
    setFromUrl(availableLanguages[0], availableLanguages);

    applySelectedLanguage();
    if(currentOptions.location){
        var titleLoc = $('#' + currentOptions.location).offset().top;
        $('#scrollable-main').scrollTop(titleLoc);
    }

    applyWaypoints();

    availableOptions.click(function(e){
        var language = $(e.target).data('language');
        currentOptions.language = language;
        applySelectedLanguage();
    });

    window.addEventListener("hashchange", hashChanged, false);

    $('pre.highlight').each(function(i, block) {
        var lines = block.textContent.split('\n');
        var matches;
        var indentation = (matches = /^\s+/.exec(lines[0])) != null ? matches[0] : null;
        if (!!indentation) {
            lines = lines.map(function(line) {
                return line.replace(indentation, '');
            });
            return block.textContent = lines.join('\n').trim();
        }
    });

    $('pre.highlight').each(function(o, block){ 
        hljs.highlightBlock(block);
    });
});
</script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-101987909-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-101987909-2');
  </script>
</body>
</html>